<odoo>
    <!--
      Flujo automático con horas fijas (noche/madrugada; sistema 7:00–20:00).
      Las horas se asignan en post_init_hook para evitar límites de safe_eval en XML.
      - 22:00 Sync último día | 23:00 Guardar facturable | 03:00 Día 1 Sync | Día 7: 02:00 TRM, 06:00 Proformas
    -->
    <record id="ir_cron_subscription_sync_last_day" model="ir.cron">
        <field name="name">Suscripciones: Último día – Actualizar productos</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model.cron_sync_last_day_of_month()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>
    <record id="ir_cron_subscription_save_billable" model="ir.cron">
        <field name="name">Suscripciones: Último día – Guardar facturable</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model.cron_save_monthly_billable_all()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>
    <record id="ir_cron_subscription_sync_first_day" model="ir.cron">
        <field name="name">Suscripciones: Día 1 – Actualizar productos (vivo)</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model.cron_sync_first_day_of_month()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>
    <record id="ir_cron_subscription_apply_trm" model="ir.cron">
        <field name="name">Suscripciones: Día 7 – Aplicar TRM a facturable guardado</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model.cron_apply_trm_saved_billables()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>
    <record id="ir_cron_subscription_proformas_from_saved" model="ir.cron">
        <field name="name">Suscripciones: Día 7 – Generar proformas desde facturable guardado</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model.cron_generate_proformas_from_saved()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>

    <record id="action_force_generate_subscription_proformas" model="ir.actions.server">
        <field name="name">Generar proformas</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model.with_context(force_generate_proforma=True).cron_generate_monthly_proformas()</field>
    </record>
</odoo>
