<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vista list líneas cuando Cotizar = USD (solo columnas USD). Prioridad mayor para usarse por defecto. -->
    <record id="view_calculadora_costos_line_list_usd" model="ir.ui.view">
        <field name="name">calculadora.costos.line.list.usd</field>
        <field name="model">calculadora.costos.line</field>
        <field name="priority">1</field>
        <field name="arch" type="xml">
            <list editable="bottom" create="0" delete="0">
                <field name="sequence" widget="handle"/>
                <field name="product_id" string="Producto" options="{'no_create': True}"/>
                <field name="name" string="Equipo"/>
                <field name="calculadora_id" column_invisible="1"/>
                <field name="valor_usd" string="Valor (USD)" options="{'digits': [16, 0]}"/>
                <field name="valor_garantia_usd" string="Garantía (USD)" options="{'digits': [16, 0]}"/>
                <field name="costo_total_cop" string="Costo total (COP)" widget="float" digits="[16, 0]" readonly="1"/>
            </list>
        </field>
    </record>
    <!-- Vista list líneas cuando Cotizar = COP (solo columnas COP) -->
    <record id="view_calculadora_costos_line_list_cop" model="ir.ui.view">
        <field name="name">calculadora.costos.line.list.cop</field>
        <field name="model">calculadora.costos.line</field>
        <field name="priority">10</field>
        <field name="arch" type="xml">
            <list editable="bottom" create="0" delete="0">
                <field name="sequence" widget="handle"/>
                <field name="product_id" string="Producto" options="{'no_create': True}"/>
                <field name="name" string="Equipo"/>
                <field name="calculadora_id" column_invisible="1"/>
                <field name="valor_cop" string="Valor (COP)" options="{'digits': [16, 0]}"/>
                <field name="valor_garantia_cop" string="Garantía (COP)" options="{'digits': [16, 0]}"/>
                <field name="costo_total_cop" string="Costo total (COP)" widget="float" digits="[16, 0]" readonly="1"/>
            </list>
        </field>
    </record>

    <record id="view_calculadora_form" model="ir.ui.view">
        <field name="name">calculadora.costos.form</field>
        <field name="model">calculadora.costos</field>
        <field name="arch" type="xml">
            <form string="Calculadora de Costos">
                <header>
                    <button name="action_generar_cotizacion" 
                            type="object" 
                            string="Generar Cotización" 
                            icon="fa-file-pdf-o"
                            class="oe_highlight"/>
                    <button name="action_print_report" 
                            type="object" 
                            string="Imprimir Reporte" 
                            icon="fa-print"/>
                </header>
                <sheet>
                    <field name="currency_id" invisible="1"/>
                    <field name="currency_usd_id" invisible="1"/>
                    <group>
                        <group>
                            <field name="name" placeholder="Ej: Renting Equipo"/>
                            <field name="tipo_calculo" invisible="1"/>
                            <field name="active"/>
                            <field name="partner_id" options="{'no_create': True, 'no_create_edit': True}"/>
                        </group>
                        <group>
                            <label for="costo_total_cop" string="Costo total (COP)"/>
                            <div>
                                <field name="costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </div>
                            <field name="pago_mensual" widget="float" digits="[16, 0]" readonly="1"/>
                            <field name="subscription_count" invisible="not partner_id"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Costos del Equipo">
                            <group>
                                <group string="Moneda de Cotización">
                                    <field name="moneda_cotizacion"/>
                                    <field name="tipo_producto" widget="radio" options="{'horizontal': true}"/>
                                    <field name="asset_category_id" invisible="tipo_producto != 'consu'"/>
                                    <p class="text-muted" colspan="2">
                                        El valor total siempre se mostrará en pesos (COP).
                                    </p>
                                </group>
                                <group string="Conversión a COP">
                                    <field name="porcentaje_utilidad" options="{'digits': [16, 0]}"/>
                                    <field name="trm" options="{'digits': [16, 0]}" invisible="moneda_cotizacion == 'cop'"/>
                                    <field name="costo_con_utilidad_usd" widget="float" 
                                           digits="[16, 0]" 
                                           readonly="1" invisible="moneda_cotizacion == 'cop'"/>
                                    <field name="costo_total_cop" widget="float" 
                                           digits="[16, 0]" readonly="1"/>
                                </group>
                            </group>
                            <group>
                                <group string="Cantidad de equipos">
                                    <field name="cantidad_equipos" options="{'min': 1, 'max': 20}"/>
                                    <p class="text-muted" colspan="2">
                                        Guarde el registro para crear o actualizar los equipos. Luego complete nombre y valor de cada equipo en los bloques de abajo.
                                    </p>
                                </group>
                            </group>
                            <!-- Campos por equipo (1 a 20): sin tabla; USD o COP según Cotizar en -->
                            <group string="Equipo 1" invisible="cantidad_equipos &lt; 1">
                                <field name="equipo_1_nombre" placeholder="Nombre o descripción"/>
                                <field name="equipo_1_product_id" options="{'no_create': True}"/>
                                <field name="equipo_1_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_1_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_1_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_1_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_1_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 2" invisible="cantidad_equipos &lt; 2">
                                <field name="equipo_2_nombre" placeholder="Nombre o descripción"/>
                                <field name="equipo_2_product_id" options="{'no_create': True}"/>
                                <field name="equipo_2_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_2_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_2_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_2_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_2_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 3" invisible="cantidad_equipos &lt; 3">
                                <field name="equipo_3_nombre" placeholder="Nombre o descripción"/>
                                <field name="equipo_3_product_id" options="{'no_create': True}"/>
                                <field name="equipo_3_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_3_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_3_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_3_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_3_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 4" invisible="cantidad_equipos &lt; 4">
                                <field name="equipo_4_nombre" placeholder="Nombre o descripción"/>
                                <field name="equipo_4_product_id" options="{'no_create': True}"/>
                                <field name="equipo_4_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_4_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_4_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_4_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_4_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 5" invisible="cantidad_equipos &lt; 5">
                                <field name="equipo_5_nombre" placeholder="Nombre o descripción"/>
                                <field name="equipo_5_product_id" options="{'no_create': True}"/>
                                <field name="equipo_5_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_5_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_5_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_5_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_5_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 6" invisible="cantidad_equipos &lt; 6">
                                <field name="equipo_6_nombre" placeholder="Nombre o descripción"/>
                                <field name="equipo_6_product_id" options="{'no_create': True}"/>
                                <field name="equipo_6_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_6_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_6_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_6_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_6_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 7" invisible="cantidad_equipos &lt; 7">
                                <field name="equipo_7_nombre"/><field name="equipo_7_product_id" options="{'no_create': True}"/>
                                <field name="equipo_7_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_7_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_7_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_7_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_7_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 8" invisible="cantidad_equipos &lt; 8">
                                <field name="equipo_8_nombre"/><field name="equipo_8_product_id" options="{'no_create': True}"/>
                                <field name="equipo_8_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_8_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_8_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_8_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_8_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 9" invisible="cantidad_equipos &lt; 9">
                                <field name="equipo_9_nombre"/><field name="equipo_9_product_id" options="{'no_create': True}"/>
                                <field name="equipo_9_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_9_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_9_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_9_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_9_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 10" invisible="cantidad_equipos &lt; 10">
                                <field name="equipo_10_nombre"/><field name="equipo_10_product_id" options="{'no_create': True}"/>
                                <field name="equipo_10_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_10_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_10_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_10_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_10_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 11" invisible="cantidad_equipos &lt; 11">
                                <field name="equipo_11_nombre"/><field name="equipo_11_product_id" options="{'no_create': True}"/>
                                <field name="equipo_11_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_11_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_11_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_11_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_11_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 12" invisible="cantidad_equipos &lt; 12">
                                <field name="equipo_12_nombre"/><field name="equipo_12_product_id" options="{'no_create': True}"/>
                                <field name="equipo_12_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_12_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_12_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_12_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_12_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 13" invisible="cantidad_equipos &lt; 13">
                                <field name="equipo_13_nombre"/><field name="equipo_13_product_id" options="{'no_create': True}"/>
                                <field name="equipo_13_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_13_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_13_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_13_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_13_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 14" invisible="cantidad_equipos &lt; 14">
                                <field name="equipo_14_nombre"/><field name="equipo_14_product_id" options="{'no_create': True}"/>
                                <field name="equipo_14_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_14_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_14_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_14_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_14_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 15" invisible="cantidad_equipos &lt; 15">
                                <field name="equipo_15_nombre"/><field name="equipo_15_product_id" options="{'no_create': True}"/>
                                <field name="equipo_15_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_15_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_15_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_15_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_15_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 16" invisible="cantidad_equipos &lt; 16">
                                <field name="equipo_16_nombre"/><field name="equipo_16_product_id" options="{'no_create': True}"/>
                                <field name="equipo_16_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_16_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_16_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_16_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_16_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 17" invisible="cantidad_equipos &lt; 17">
                                <field name="equipo_17_nombre"/><field name="equipo_17_product_id" options="{'no_create': True}"/>
                                <field name="equipo_17_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_17_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_17_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_17_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_17_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 18" invisible="cantidad_equipos &lt; 18">
                                <field name="equipo_18_nombre"/><field name="equipo_18_product_id" options="{'no_create': True}"/>
                                <field name="equipo_18_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_18_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_18_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_18_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_18_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 19" invisible="cantidad_equipos &lt; 19">
                                <field name="equipo_19_nombre"/><field name="equipo_19_product_id" options="{'no_create': True}"/>
                                <field name="equipo_19_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_19_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_19_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_19_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_19_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                            <group string="Equipo 20" invisible="cantidad_equipos &lt; 20">
                                <field name="equipo_20_nombre"/><field name="equipo_20_product_id" options="{'no_create': True}"/>
                                <field name="equipo_20_valor_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_20_garantia_usd" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'usd'"/>
                                <field name="equipo_20_valor_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_20_garantia_cop" options="{'digits': [16, 0]}" invisible="moneda_cotizacion != 'cop'"/>
                                <field name="equipo_20_costo_total_cop" widget="float" digits="[16, 0]" readonly="1"/>
                            </group>
                        </page>
                        <page string="Servicios Técnicos">
                            <group>
                                <group>
                                    <field name="costo_servicios_completos" 
                                           placeholder="Valor anual (USD si cotizas en USD, COP si cotizas en COP)" 
                                           options="{'digits': [16, 0]}"/>
                                    <field name="porcentaje_margen_servicio" options="{'digits': [16, 0]}"/>
                                    <field name="servicio_con_margen_cop" widget="float" 
                                           digits="[16, 0]" readonly="1"/>
                                </group>
                            </group>
                        </page>
                        <page string="Parámetros Financieros">
                            <group>
                                <group string="Tasas de Interés">
                                    <field name="tasa_nominal" options="{'digits': [16, 0]}"/>
                                    <field name="tasa_mensual" readonly="1" options="{'digits': [16, 0]}"/>
                                    <field name="tasa_efectiva_anual" readonly="1" options="{'digits': [16, 0]}"/>
                                </group>
                                <group string="Plazo">
                                    <field name="plazo_meses"/>
                                </group>
                            </group>
                        </page>
                        <page string="Opción de Compra">
                            <group>
                                <group>
                                    <field name="porcentaje_opcion_compra" options="{'digits': [16, 0]}"/>
                                    <field name="valor_opcion_compra" widget="float" 
                                           digits="[16, 0]" readonly="1"/>
                                </group>
                            </group>
                        </page>
                        <page string="Valores por Plazo">
                            <group>
                                <group string="Comparación de Plazos (cuota = costo total ÷ meses)">
                                    <label for="valor_12_meses" string="12 Meses:"/>
                                    <div>
                                        <field name="valor_12_meses" widget="float" 
                                               digits="[16, 0]" readonly="1"/>
                                    </div>
                                    <label for="valor_24_meses" string="24 Meses:"/>
                                    <div>
                                        <field name="valor_24_meses" widget="float" 
                                               digits="[16, 0]" readonly="1"/>
                                    </div>
                                    <label for="valor_36_meses" string="36 Meses:"/>
                                    <div>
                                        <field name="valor_36_meses" widget="float" 
                                               digits="[16, 0]" readonly="1"/>
                                    </div>
                                    <label for="valor_48_meses" string="48 Meses:"/>
                                    <div>
                                        <field name="valor_48_meses" widget="float" 
                                               digits="[16, 0]" readonly="1"/>
                                    </div>
                                    <label for="valor_60_meses" string="60 Meses:"/>
                                    <div>
                                        <field name="valor_60_meses" widget="float" 
                                               digits="[16, 0]" readonly="1"/>
                                    </div>
                                </group>
                            </group>
                        </page>
                        <page string="Suscripciones No Contables" invisible="not partner_id">
                            <group>
                                <group>
                                    <label for="partner_id" string="Cliente:"/>
                                    <div>
                                        <field name="partner_id" options="{'no_create': True, 'no_create_edit': True}"/>
                                    </div>
                                    <label for="subscription_count" string="Suscripciones Activas:"/>
                                    <div>
                                        <field name="subscription_count" readonly="1"/>
                                    </div>
                                    <div>
                                        <button name="action_view_subscriptions" 
                                                string="Ver Suscripciones Activas" 
                                                type="object" 
                                                class="btn-primary"
                                                icon="fa-file-text"
                                                invisible="not partner_id"/>
                                    </div>
                                </group>
                            </group>
                            <div class="alert alert-info" role="alert" invisible="partner_id">
                                <strong>Nota:</strong> Seleccione un cliente para ver sus suscripciones no contables activas.
                            </div>
                        </page>
                        <page string="Notas">
                            <group>
                                <field name="notas" placeholder="Notas adicionales sobre el cálculo..."/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_calculadora_list" model="ir.ui.view">
        <field name="name">calculadora.costos.list</field>
        <field name="model">calculadora.costos</field>
        <field name="arch" type="xml">
            <list string="Calculadoras" decoration-muted="active == False">
                <field name="currency_id" optional="hide"/>
                <field name="currency_usd_id" optional="hide"/>
                <field name="name"/>
                <field name="tipo_calculo"/>
                <field name="moneda_cotizacion"/>
                <field name="partner_id"/>
                <field name="valor_usd" widget="float" digits="[16, 0]"/>
                <field name="valor_cop" widget="float" digits="[16, 0]"/>
                <field name="costo_total_cop" widget="float" digits="[16, 0]"/>
                <field name="pago_mensual" widget="float" digits="[16, 0]"/>
                <field name="plazo_meses"/>
                <field name="subscription_count" invisible="not partner_id"/>
                <field name="active"/>
            </list>
        </field>
    </record>

    <record id="view_calculadora_search" model="ir.ui.view">
        <field name="name">calculadora.costos.search</field>
        <field name="model">calculadora.costos</field>
        <field name="arch" type="xml">
            <search string="Buscar Calculadoras">
                <field name="name" string="Nombre"/>
                <field name="partner_id" string="Cliente"/>
                <separator/>
                <filter string="Activos" name="filter_active" domain="[('active', '=', True)]"/>
                <filter string="Inactivos" name="filter_inactive" domain="[('active', '=', False)]"/>
                <group expand="0" string="Agrupar por">
                    <filter string="Cliente" name="group_partner" context="{'group_by': 'partner_id'}"/>
                    <filter string="Plazo" name="group_plazo" context="{'group_by': 'plazo_meses'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="action_calculadora" model="ir.actions.act_window">
        <field name="name">Calculadora de Costos</field>
        <field name="res_model">calculadora.costos</field>
        <field name="view_mode">list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Crear nueva calculadora
            </p>
            <p>
                La calculadora permite calcular costos para renting.
                Complete los datos necesarios para realizar el cálculo.
            </p>
        </field>
    </record>
</odoo>
