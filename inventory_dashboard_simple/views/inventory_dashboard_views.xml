<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Vista Kanban para grupos de operaciones -->
        <record id="view_inventory_dashboard_group_kanban" model="ir.ui.view">
            <field name="name">inventory.dashboard.group.kanban</field>
            <field name="model">inventory.dashboard.group</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_dashboard" create="0" default_order="sequence">
                    <field name="name"/>
                    <field name="sequence"/>
                    <field name="total_count"/>
                    <field name="waiting_count"/>
                    <field name="delay_count"/>
                    <field name="color"/>
                    <field name="picking_type_ids"/>
                    <button name="action_open" type="object" string="Ver Operaciones" class="oe_kanban_action" icon="fa-list"/>
                    <templates>
                        <t t-name="card">
                            <div class="oe_kanban_card oe_kanban_global_click" 
                                 t-attf-style="border-left: 5px solid #{record.color.raw_value ? ['#6c757d', '#5eb5d9', '#7ec8e3', '#3a8fb5', '#2d6a8a', '#e83e8c', '#fd7e14', '#dc3545', '#856404'][record.color.raw_value] : '#6c757d'}; cursor: pointer; box-shadow: 0 8px 24px rgba(0,0,0,0.08), 0 2px 8px rgba(0,0,0,0.04); border-radius: 20px; overflow: hidden; background: #ffffff; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); position: relative;"
                                 t-att-data-record-id="record.id.raw_value">
                                <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, rgba(0,0,0,0.04) 0%, rgba(0,0,0,0.06) 100%);"></div>
                                <div class="o_kanban_card_header" style="background: #ffffff; padding: 18px 16px; border-bottom: 1px solid rgba(0,0,0,0.06);">
                                    <div class="o_kanban_card_header_title">
                                        <div class="o_primary" style="text-align: center;">
                                            <strong style="font-size: 18px; color: #2c3e50; font-weight: 700; letter-spacing: 0.5px; text-transform: uppercase;">
                                                <field name="name"/>
                                            </strong>
                                        </div>
                                    </div>
                                </div>
                                <div class="o_kanban_card_content" style="padding: 20px; background: #ffffff;">
                                    <div class="row mb-3">
                                        <div class="col-12 text-center mb-3">
                                            <div style="background: linear-gradient(135deg, #c5e3ee 0%, #a8d4e6 100%); border: 2px solid rgba(94,181,217,0.5); color: #3a8fb5; padding: 18px; border-radius: 18px; box-shadow: 0 4px 16px rgba(74,163,201,0.2), inset 0 1px 0 rgba(255,255,255,0.5); position: relative; overflow: hidden;">
                                                <div style="position: absolute; top: -50%; right: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);"></div>
                                                <div style="font-size: 11px; opacity: 0.9; margin-bottom: 6px; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; position: relative; display: flex; align-items: center; justify-content: center; gap: 6px;">
                                                    <span style="font-size: 14px;">üìà</span>
                                                    <span>TOTAL</span>
                                                </div>
                                                <div style="font-size: 32px; font-weight: 800; position: relative; text-shadow: 0 2px 4px rgba(58,143,181,0.15); color: #2d6a8a;">
                                                    <field name="total_count"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6 text-center">
                                            <div style="background: linear-gradient(135deg, rgba(255,243,205,0.95) 0%, rgba(255,235,156,0.95) 100%); border: 2px solid rgba(255,193,7,0.5); border-radius: 16px; padding: 14px 8px; margin: 4px; box-shadow: 0 3px 12px rgba(255,193,7,0.25), inset 0 1px 0 rgba(255,255,255,0.6); position: relative; overflow: hidden;">
                                                <div style="position: absolute; top: -30%; left: -30%; width: 160%; height: 160%; background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, transparent 70%);"></div>
                                                <div style="font-size: 9px; color: #856404; font-weight: 700; margin-bottom: 6px; letter-spacing: 0.5px; text-transform: uppercase; position: relative; display: flex; align-items: center; justify-content: center; gap: 4px;">
                                                    <span style="font-size: 12px;">‚è±Ô∏è</span>
                                                    <span>EN ESPERA</span>
                                                </div>
                                                <div style="font-size: 22px; font-weight: 800; color: #856404; position: relative; text-shadow: 0 1px 3px rgba(133,100,4,0.2);">
                                                    <field name="waiting_count"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-6 text-center">
                                            <div style="background: linear-gradient(135deg, rgba(248,215,218,0.95) 0%, rgba(245,183,190,0.95) 100%); border: 2px solid rgba(220,53,69,0.5); border-radius: 16px; padding: 14px 8px; margin: 4px; box-shadow: 0 3px 12px rgba(220,53,69,0.25), inset 0 1px 0 rgba(255,255,255,0.6); position: relative; overflow: hidden;">
                                                <div style="position: absolute; top: -30%; right: -30%; width: 160%; height: 160%; background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, transparent 70%);"></div>
                                                <div style="font-size: 9px; color: #721c24; font-weight: 700; margin-bottom: 6px; letter-spacing: 0.5px; text-transform: uppercase; position: relative; display: flex; align-items: center; justify-content: center; gap: 4px;">
                                                    <span style="font-size: 12px;">üö®</span>
                                                    <span>CON DEMORA</span>
                                                </div>
                                                <div style="font-size: 22px; font-weight: 800; color: #721c24; position: relative; text-shadow: 0 1px 3px rgba(114,28,36,0.2);">
                                                    <field name="delay_count"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- √Årea de alertas con altura fija para mantener alineaci√≥n -->
                                    <div class="row mt-3" style="min-height: 90px; margin-bottom: 8px;">
                                        <div class="col-12 mb-2" t-if="record.waiting_count.raw_value > 0">
                                            <div style="background: linear-gradient(135deg, rgba(255,193,7,0.95) 0%, rgba(255,235,156,0.95) 100%); color: #856404; padding: 12px; border-radius: 14px; text-align: center; font-weight: 700; font-size: 12px; border: 1px solid rgba(255,193,7,0.6); box-shadow: 0 3px 10px rgba(255,193,7,0.3), inset 0 1px 0 rgba(255,255,255,0.5); position: relative; overflow: hidden;">
                                                <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);"></div>
                                                <span style="position: relative; display: flex; align-items: center; justify-content: center; gap: 6px;">
                                                    <span style="font-size: 14px;">‚è≥</span>
                                                    <span>Atenci√≥n: Hay operaciones en espera</span>
                                                </span>
                                            </div>
                                        </div>
                                        <div class="col-12" t-if="record.delay_count.raw_value > 0">
                                            <div style="background: linear-gradient(135deg, rgba(220,53,69,0.95) 0%, rgba(245,183,190,0.95) 100%); color: white; padding: 12px; border-radius: 14px; text-align: center; font-weight: 700; font-size: 12px; box-shadow: 0 3px 10px rgba(220,53,69,0.3), inset 0 1px 0 rgba(255,255,255,0.3); position: relative; overflow: hidden;">
                                                <div style="position: absolute; top: -50%; right: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);"></div>
                                                <span style="position: relative; display: flex; align-items: center; justify-content: center; gap: 6px;">
                                                    <span style="font-size: 14px;">‚ö†Ô∏è</span>
                                                    <span>Atenci√≥n: Hay operaciones con demora</span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row" style="margin-top: 10px;">
                                        <div class="col-12 text-center">
                                            <button name="action_open" type="object" class="btn oe_kanban_btn_operaciones" style="width: 100%; padding: 14px; font-weight: 700; border-radius: 6px; letter-spacing: 0.5px; text-transform: uppercase; font-size: 13px; position: relative; overflow: hidden;">
                                                <span style="position: relative; z-index: 1; display: flex; align-items: center; justify-content: center; gap: 6px;">
                                                    <span style="font-size: 14px;">üìä</span>
                                                    <span>Ver Operaciones</span>
                                                </span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!-- Vista List para grupos -->
        <record id="view_inventory_dashboard_group_list" model="ir.ui.view">
            <field name="name">inventory.dashboard.group.list</field>
            <field name="model">inventory.dashboard.group</field>
            <field name="arch" type="xml">
                <list>
                    <field name="active" widget="boolean_toggle"/>
                    <field name="sequence" widget="handle"/>
                    <field name="name"/>
                    <field name="total_count"/>
                    <field name="waiting_count"/>
                    <field name="delay_count"/>
                </list>
            </field>
        </record>

        <!-- Vista Form para grupos -->
        <record id="view_inventory_dashboard_group_form" model="ir.ui.view">
            <field name="name">inventory.dashboard.group.form</field>
            <field name="model">inventory.dashboard.group</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <field name="active" widget="boolean_toggle"/>
                            <field name="name"/>
                            <field name="sequence"/>
                            <field name="color"/>
                        </group>
                        <group>
                            <field name="picking_type_ids" widget="many2many_tags"/>
                        </group>
                        <group>
                            <field name="total_count" readonly="1"/>
                            <field name="waiting_count" readonly="1"/>
                            <field name="delay_count" readonly="1"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Acci√≥n para el dashboard (solo vista kanban) -->
        <record id="action_inventory_dashboard" model="ir.actions.act_window">
            <field name="name">Dashboard de Inventario</field>
            <field name="res_model">inventory.dashboard.group</field>
            <field name="view_mode">kanban</field>
            <field name="domain">[('active', '=', True)]</field>
            <field name="view_ids" eval="[(5, 0, 0), (0, 0, {'view_mode': 'kanban', 'view_id': ref('view_inventory_dashboard_group_kanban')})]"/>
            <field name="target">current</field>
            <field name="context">{'search_default_sequence': 1}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Dashboard de operaciones de inventario agrupadas por tipo.
                </p>
                <p>
                    Las operaciones est√°n agrupadas por tipo (Recibidos, Traslados, √ìrdenes de entrega, etc.)
                    para facilitar la navegaci√≥n. Haz clic en cualquier tarjeta para ver las operaciones de ese tipo.
                </p>
            </field>
        </record>
        
        <!-- Acci√≥n para configuraci√≥n (vista lista/form) -->
        <record id="action_inventory_dashboard_config" model="ir.actions.act_window">
            <field name="name">Configurar Grupos de Operaciones</field>
            <field name="res_model">inventory.dashboard.group</field>
            <field name="view_mode">list,form</field>
            <field name="view_id" ref="view_inventory_dashboard_group_list"/>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Configuraci√≥n de grupos de operaciones.
                </p>
                <p>
                    Aqu√≠ puedes editar los grupos de operaciones, cambiar sus nombres, secuencias, colores y asignar tipos de operaci√≥n.
                </p>
            </field>
        </record>
        
        <!-- Acci√≥n de servidor para inicializar grupos -->
        <record id="action_init_groups" model="ir.actions.server">
            <field name="name">Inicializar Grupos de Operaciones</field>
            <field name="model_id" ref="model_inventory_dashboard_group"/>
            <field name="state">code</field>
            <field name="code">
env['inventory.dashboard.group'].init_groups()
            </field>
        </record>


    </data>
</odoo>

