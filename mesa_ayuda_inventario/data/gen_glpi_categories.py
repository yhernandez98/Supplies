# -*- coding: utf-8 -*-
"""Genera data/helpdesk_ticket_category_data.xml desde el listado GLPI (id, name, completename, entities_id, parent_id, level)."""
import xml.sax.saxutils

RAW = """2	Acceso Remoto	SOPORTE Y SERVICIOS > Acceso Remoto	84	19	2
199	Acceso Remoto	SITIO > APLICACIONES > Acceso Remoto	84	215	3
248	Acceso Remoto	REMOTO > APLICACIONES > Acceso Remoto	84	247	3
313	Acceso Remoto Mytech	SOPORTE Y SERVICIOS MYTECH > Acceso Remoto Mytech	261	312	2
353	ACCESS CONTROL	INFRASTRUCTURE > ACCESS CONTROL	261	351	2
372	ACTIVE DIRECTORY MANAGEMENT	PLATFORMS > ACTIVE DIRECTORY MANAGEMENT	261	365	2
289	Actualización datos entidades	DESARROLLO > Actualización datos entidades	84	27	2
150	Adecuación	HARDWARE > Adecuación	101	125	2
240	Administración Antivirus	PLATAFORMAS > Administración Antivirus	84	237	2
279	Administración Copias de seguridad (Backup)	PLATAFORMAS > Administración Copias de seguridad (Backup)	84	237	2
241	Administración Correo	PLATAFORMAS > Administración Correo	84	237	2
506	Administración de inventarios	PLATAFORMAS > Administración de inventarios	84	237	2
216	Administración Directorio Activo	PLATAFORMAS > Administración Directorio Activo	84	237	2
203	Administración Dominio	PLATAFORMAS > Administración Dominio	84	237	2
243	Administración Firewall/Router	PLATAFORMAS > Administración Firewall/Router	84	237	2
309	Administración Intune	PLATAFORMAS > Administración Intune	84	237	2
242	Administración Microsoft 365	PLATAFORMAS > Administración Microsoft 365	84	237	2
244	Administración Telefonía	PLATAFORMAS > Administración Telefonía	84	237	2
141	Alistamiento - AIO	ALISTAMIENTOS > Alistamiento - AIO	84	9	2
11	Alistamiento - General	ALISTAMIENTOS > Alistamiento - General	84	9	2
140	Alistamiento - Laptop	ALISTAMIENTOS > Alistamiento - Laptop	84	9	2
280	Alistamiento - Monitor	ALISTAMIENTOS > Alistamiento - Monitor	84	9	2
142	Alistamiento - Teléfono	ALISTAMIENTOS > Alistamiento - Teléfono	84	9	2
143	Alistamiento - Torre	ALISTAMIENTOS > Alistamiento - Torre	84	9	2
157	Alistamiento de AIO Excel Credit	ALISTAMIENTOS > Alistamiento de AIO Excel Credit	31	9	2
156	Alistamiento de Laptop Excel Credit	ALISTAMIENTOS > Alistamiento de Laptop Excel Credit	31	9	2
9	ALISTAMIENTOS	ALISTAMIENTOS	84	0	1
174	AMBIENTE DE PRUEBAS	DESARROLLO > AMBIENTE DE PRUEBAS	95	27	2
166	Antivirus	SOPORTE Y SERVICIOS > Antivirus	84	19	2
200	ANTIVIRUS	SITIO > ANTIVIRUS	84	198	2
235	ANTIVIRUS	REMOTO > ANTIVIRUS	84	232	2
370	ANTIVIRUS	REMOTE > ANTIVIRUS	261	368	2
435	ANTIVIRUS	SITE > ANTIVIRUS	261	434	2
444	ANTIVIRUS	SUPPORT AND SERVICES > ANTIVIRUS	261	440	2
366	ANTIVIRUS MANAGEMENT	PLATFORMS > ANTIVIRUS MANAGEMENT	261	365	2
131	Anydesk	APLICACIONES DE TERCEROS > Anydesk	84	77	2
323	ANYDESK	THIRD-PARTY APPLICATIONS > ANYDESK	261	322	2
215	APLICACIONES	SITIO > APLICACIONES	84	198	2
247	APLICACIONES	REMOTO > APLICACIONES	84	232	2
77	APLICACIONES DE TERCEROS	APLICACIONES DE TERCEROS	84	0	1
221	Apoyo técnico en sitio	SITIO > Apoyo técnico en sitio	84	198	2
256	Apoyo técnico via remota.	REMOTO > Apoyo técnico via remota.	84	232	2
371	APPLICATIONS	REMOTE > APPLICATIONS	261	368	2
439	APPLICATIONS	SITE > APPLICATIONS	261	434	2
362	ASSET REQUEST	LOGISTICS > ASSET REQUEST	261	359	2
358	ASSET VERIFICATION IN LABORATORY	INVENTORY > ASSET VERIFICATION IN LABORATORY	261	356	2
426	Backup Configuration	BACKUP SOLUTIONS > Backup Configuration	261	425	2
504	BACKUP CONFIGURATION	SITE > BACKUP SOLUTIONS > BACKUP CONFIGURATION	261	503	3
367	BACKUP MANAGEMENT	PLATFORMS > BACKUP MANAGEMENT	261	365	2
218	Backup sobre correo	SITIO > CORREO > Backup sobre correo	84	202	3
264	Backup sobre correo	REMOTO > CORREO > Backup sobre correo	84	263	3
379	BACKUP SOLUTIONS	REMOTE > BACKUP SOLUTIONS	261	368	2
425	BACKUP SOLUTIONS	BACKUP SOLUTIONS	261	0	1
503	BACKUP SOLUTIONS	SITE > BACKUP SOLUTIONS	261	434	2
395	BIOMETRIC	REMOTE > APPLICATIONS > BIOMETRIC	261	371	3
443	BIOMETRIC	SITE > APPLICATIONS > BIOMETRIC	261	439	3
445	BIOMETRIC	SUPPORT AND SERVICES > BIOMETRIC	261	440	2
168	Biometrico	SOPORTE Y SERVICIOS > Biometrico	84	19	2
228	Biométrico	SITIO > APLICACIONES > Biométrico	84	215	3
257	Biométrico	REMOTO > APLICACIONES > Biométrico	84	247	3
78	Bitdefender	SOPORTE Y SERVICIOS > Bitdefender	84	19	2
209	Bitdefender	SITIO > ANTIVIRUS > Bitdefender	84	200	3
236	Bitdefender	REMOTO > ANTIVIRUS > Bitdefender	84	235	3
388	BITDEFENDER	REMOTE > ANTIVIRUS > BITDEFENDER	261	370	3
436	BITDEFENDER	SITE > ANTIVIRUS > BITDEFENDER	261	435	3
447	BITDEFENDER	SUPPORT AND SERVICES > BITDEFENDER	261	440	2
310	CAMBIO DE EQUIPO	SITIO > COMPUTO > CAMBIO DE EQUIPO	84	212	3
29	Carpetas compartidas	SOPORTE Y SERVICIOS > Carpetas compartidas	84	19	2
201	Carpetas compartidas	SITIO > COMPUTO > Carpetas compartidas	84	212	3
258	Carpetas compartidas	REMOTO > COMPUTO > Carpetas compartidas	84	259	3
32	CCTV	INFRAESTRUCTURA > CCTV	84	31	2
352	CCTV	INFRASTRUCTURE > CCTV	261	351	2
295	Cisco webex	REMOTO > APLICACIONES > Cisco webex	84	247	3
398	CISCO WEBEX	REMOTE > APPLICATIONS > CISCO WEBEX	261	371	3
431	CLAIM	CUSTOMER SERVICE > PQRSF > CLAIM	261	423	3
128	Clonacion	SOFTWARE > Clonacion	101	127	2
22	COMERCIAL	COMERCIAL	84	0	1
335	COMMERCIAL	COMMERCIAL	261	0	1
223	Comoprint	SITIO > IMPRESORAS Y ESCANER > Comoprint	84	222	3
268	Comoprint	REMOTO > IMPRESORAS Y ESCANER > Comoprint	84	267	3
418	COMOPRINT	REMOTE > PRINTERS AND SCANNERS > COMOPRINT	261	376	3
492	COMOPRINT	SITE > PRINTERS AND SCANNERS > COMOPRINT	261	491	3
430	COMPLAINT	CUSTOMER SERVICE > PQRSF > COMPLAINT	261	423	3
212	COMPUTO	SITIO > COMPUTO	84	198	2
259	COMPUTO	REMOTO > COMPUTO	84	232	2
382	COMPUTO	REMOTE > COMPUTO	261	368	2
463	COMPUTO	SITE > COMPUTO	261	434	2
307	Configuracion Microsoft Intune	SITIO > COMPUTO > Configuracion Microsoft Intune	84	212	3
308	Configuracion Microsoft Intune	REMOTO > COMPUTO > Configuracion Microsoft Intune	84	259	3
204	Configuración / instalación	SITIO > IMPRESORAS Y ESCANER > Configuración / instalación	84	222	3
269	Configuración / instalación	REMOTO > IMPRESORAS Y ESCANER > Configuración / instalación	84	267	3
225	Configuración de Backup	SITIO > SOLUCIONES DE BACKUP > Configuración de Backup	84	219	3
274	Configuración de Backup	REMOTO > SOLUCIONES DE BACKUP > Configuración de Backup	84	273	3
226	Configuración de VPN	SITIO > REDES E INTERNET > Configuración de VPN	84	207	3
271	Configuración de VPN	REMOTO > REDES E INTERNET > Configuración de VPN	84	270	3
220	Configuración en Gmail	SITIO > CORREO > Configuración en Gmail	84	202	3
265	Configuración en Gmail	REMOTO > CORREO > Configuración en Gmail	84	263	3
217	Configuración en Outlook	SITIO > CORREO > Configuración en Outlook	84	202	3
266	Configuración en Outlook	REMOTO > CORREO > Configuración en Outlook	84	263	3
158	Configuración equipos Invest in Bogotá	SOPORTE Y SERVICIOS > Configuración equipos Invest in Bogotá	95	19	2
205	Configuración NAS	SITIO > SOLUCIONES DE BACKUP > Configuración NAS	84	219	3
275	Configuración NAS	REMOTO > SOLUCIONES DE BACKUP > Configuración NAS	84	273	3
419	CONFIGURATION / INSTALLATION	REMOTE > PRINTERS AND SCANNERS > CONFIGURATION / INSTALLATION	261	376	3
493	CONFIGURATION / INSTALLATION	SITE > PRINTERS AND SCANNERS > CONFIGURATION / INSTALLATION	261	491	3
427	CONGRATULATIONS	CUSTOMER SERVICE > PQRSF > CONGRATULATIONS	261	423	3
72	CONTROL DE ACCESO	INFRAESTRUCTURA > CONTROL DE ACCESO	84	31	2
15	Correo	SOPORTE Y SERVICIOS > Correo	84	19	2
202	CORREO	SITIO > CORREO	84	198	2
263	CORREO	REMOTO > CORREO	84	232	2
24	Cotización	COMERCIAL > Cotización	84	22	2
306	Creación usuarios/actualización	DESARROLLO > Creación y actualizacion de usuarios	84	27	2
175	Creación y actualizacion de entidades	DESARROLLO > Creación y actualizacion de entidades	84	27	2
342	CREATION AND UPDATE OF ENTITIES	DEVELOPMENT > CREATION AND UPDATE OF ENTITIES	261	339	2
343	CREATION AND UPDATE OF USERS	DEVELOPMENT > CREATION AND UPDATE OF USERS	261	339	2
16	Cuentas de usuario y permisos	SOPORTE Y SERVICIOS > Cuentas de usuario y permisos	84	19	2
421	CUSTOMER SERVICE	CUSTOMER SERVICE	261	0	1
360	DELIVERY	LOGISTICS > DELIVERY	261	359	2
27	DESARROLLO	DESARROLLO	84	0	1
339	DEVELOPMENT	DEVELOPMENT	261	0	1
83	Dms	APLICACIONES DE TERCEROS > Dms	84	77	2
324	DMS	THIRD-PARTY APPLICATIONS > DMS	261	322	2
374	DOMAIN MANAGEMENT	PLATFORMS > DOMAIN MANAGEMENT	261	365	2
123	Dominio	Dominio	0	0	1
89	DyD	APLICACIONES DE TERCEROS > DyD	84	77	2
325	DYD	THIRD-PARTY APPLICATIONS > DYD	261	322	2
375	EMAIL	REMOTE > EMAIL	261	368	2
452	EMAIL	SUPPORT AND SERVICES > EMAIL	261	440	2
487	EMAIL	SITE > EMAIL	261	434	2
415	EMAIL BACKUP	REMOTE > EMAIL > EMAIL BACKUP	261	375	3
488	EMAIL BACKUP	SITE > EMAIL > EMAIL BACKUP	261	487	3
369	EMAIL MANAGEMENT	PLATFORMS > EMAIL MANAGEMENT	261	365	2
8	Entrega	LOGISTICA > Entrega	84	6	2
138	Entrega	TRANSPORTADORA > Entrega	84	137	2
299	Especializadas	REMOTO > APLICACIONES > Especializadas	95	247	3
300	Especializadas	SITIO > APLICACIONES > Especializadas	95	215	3
126	Falla de hardware	HARDWARE > Falla de hardware	101	125	2
165	Felicitación	SERVICIO AL CLIENTE > PQRSF > Felicitación	84	160	3
344	FINNOVATING	DEVELOPMENT > FINNOVATING	261	339	2
377	FIREWALL/ROUTER MANAGEMENT	PLATFORMS > FIREWALL/ROUTER MANAGEMENT	261	365	2
133	Garantia con HP	GARANTIAS y REPARACIONES > Garantia con HP	84	132	2
132	GARANTIAS y REPARACIONES	GARANTIAS y REPARACIONES	84	0	1
338	GENERATED OPPORTUNITY	COMMERCIAL > GENERATED OPPORTUNITY	261	335	2
347	GLPI SUPPORT	DEVELOPMENT > GLPI SUPPORT	261	339	2
416	GMAIL CONFIGURATION	REMOTE > EMAIL > GMAIL CONFIGURATION	261	375	3
489	GMAIL CONFIGURATION	SITE > EMAIL > GMAIL CONFIGURATION	261	487	3
125	HARDWARE	HARDWARE	101	0	1
214	Hardware	SITIO > COMPUTO > Hardware	84	212	3
476	HARDWARE	SITE > COMPUTO > HARDWARE	261	463	3
507	HARDWARE	HARDWARE	284	0	1
81	Helisa	APLICACIONES DE TERCEROS > Helisa	84	77	2
234	Helisa	SITIO > APLICACIONES > Helisa	84	215	3
249	Helisa	REMOTO > APLICACIONES > Helisa	84	247	3
326	HELISA	THIRD-PARTY APPLICATIONS > HELISA	261	322	2
401	HELISA	REMOTE > APPLICATIONS > HELISA	261	371	3
446	HELISA	SITE > APPLICATIONS > HELISA	261	439	3
85	Historias clinicas	APLICACIONES DE TERCEROS > Historias clinicas	84	77	2
327	HISTORIAS CLINICAS	THIRD-PARTY APPLICATIONS > HISTORIAS CLINICAS	261	322	2
350	HP	WARRANTIES > HP	261	349	2
76	Impresoras - Comoprint e inspección	SOPORTE Y SERVICIOS > Impresoras - Comoprint e inspección	84	19	2
23	Impresoras y escaner	SOPORTE Y SERVICIOS > Impresoras y escaner	84	19	2
222	IMPRESORAS Y ESCANER	SITIO > IMPRESORAS Y ESCANER	84	198	2
267	IMPRESORAS Y ESCANER	REMOTO > IMPRESORAS Y ESCANER	84	232	2
31	INFRAESTRUCTURA	INFRAESTRUCTURA	84	0	1
351	INFRASTRUCTURE	INFRASTRUCTURE	261	0	1
433	INITIAL REQUIREMENT OR INCIDENCE	INITIAL REQUIREMENT OR INCIDENCE	261	0	1
422	INTERNET SERVICE REVIEW	REMOTE > NETWORKS AND INTERNET > INTERNET SERVICE REVIEW	261	378	3
501	INTERNET SERVICE REVIEW	SITE > NETWORKS AND INTERNET > INTERNET SERVICE REVIEW	261	497	3
380	INTUNE MANAGEMENT	PLATFORMS > INTUNE MANAGEMENT	261	365	2
176	INVENTARIO	INVENTARIO	84	0	1
356	INVENTORY	INVENTORY	261	0	1
357	INVENTORY REQUEST BY CLIENTS	INVENTORY > INVENTORY REQUEST BY CLIENTS	261	356	2
464	KARSPERSKY	SUPPORT AND SERVICES > KARSPERSKY	261	440	2
167	Kaspersky	SOPORTE Y SERVICIOS > Kaspersky	84	19	2
210	Kaspersky	SITIO > ANTIVIRUS > Kaspersky	84	200	3
245	Kaspersky	REMOTO > ANTIVIRUS > Kaspersky	84	235	3
389	KASPERSKY	REMOTE > ANTIVIRUS > KASPERSKY	261	370	3
437	KASPERSKY	SITE > ANTIVIRUS > KASPERSKY	261	435	3
26	Licenciamiento	COMERCIAL > Licenciamiento	84	22	2
337	LICENSING	COMMERCIAL > LICENSING	261	335	2
6	LOGISTICA	LOGISTICA	84	0	1
359	LOGISTICS	LOGISTICS	261	0	1
396	MAINTENANCE	REMOTE > COMPUTO > MAINTENANCE	261	382	3
465	MAINTENANCE	SUPPORT AND SERVICES > MAINTENANCE	261	440	2
479	MAINTENANCE	SITE > COMPUTO > MAINTENANCE	261	463	3
5	Mantenimiento	SOPORTE Y SERVICIOS > Mantenimiento	84	19	2
213	Mantenimiento	SITIO > COMPUTO > Mantenimiento	84	212	3
261	Mantenimiento	REMOTO > COMPUTO > Mantenimiento	84	259	3
151	Mantenimiento Externo	HARDWARE > Mantenimiento Externo	101	125	2
224	Mantenimiento Impresora	SITIO > IMPRESORAS Y ESCANER > Mantenimiento Impresora	84	222	3
152	Mantenimiento Interno	HARDWARE > Mantenimiento Interno	101	125	2
508	Mantenimiento Interno	HARDWARE > Mantenimiento Interno	284	507	2
285	Mantenimiento Programado	REMOTO > COMPUTO > Mantenimiento Programado	84	259	3
286	Mantenimiento Programado	SITIO > COMPUTO > Mantenimiento Programado	84	212	3
88	Meco	APLICACIONES DE TERCEROS > Meco	84	77	2
328	MECO	THIRD-PARTY APPLICATIONS > MECO	261	322	2
82	Med	APLICACIONES DE TERCEROS > Med	84	77	2
233	Med	SITIO > APLICACIONES > Med	84	215	3
250	Med	REMOTO > APLICACIONES > Med	84	247	3
329	MED	THIRD-PARTY APPLICATIONS > MED	261	322	2
402	MED	REMOTE > APPLICATIONS > MED	261	371	3
448	MED	SITE > APPLICATIONS > MED	261	439	3
405	MICROSOFT  TEAMS	REMOTE > APPLICATIONS > MICROSOFT  TEAMS	261	371	3
383	MICROSOFT 365 MANAGEMENT	PLATFORMS > MICROSOFT 365 MANAGEMENT	261	365	2
311	Microsoft Entra ID	PLATAFORMAS > Microsoft Entra ID	95	237	2
385	MICROSOFT ENTRA ID	PLATFORMS > MICROSOFT ENTRA ID	261	365	2
394	MICROSOFT INTUNE CONFIGURATION	REMOTE > COMPUTO > MICROSOFT INTUNE CONFIGURATION	261	382	3
473	MICROSOFT INTUNE SETTINGS	SITE > COMPUTO > MICROSOFT INTUNE SETTINGS	261	463	3
301	Microsoft OneDrive	REMOTO > APLICACIONES > Microsoft OneDrive	84	247	3
302	Microsoft OneDrive	SITIO > APLICACIONES > Microsoft OneDrive	84	215	3
403	MICROSOFT ONEDRIVE	REMOTE > APPLICATIONS > MICROSOFT ONEDRIVE	261	371	3
450	MICROSOFT ONEDRIVE	SITE > APPLICATIONS > MICROSOFT ONEDRIVE	261	439	3
296	Microsoft Teams	REMOTO > APLICACIONES > Microsoft Teams	84	247	3
303	Microsoft teams	SITIO > APLICACIONES > Microsoft teams	84	215	3
451	MICROSOFT TEAMS	SITE > APPLICATIONS > MICROSOFT TEAMS	261	439	3
400	MOVEMENTS BY ASSIGNMENT	REMOTE > COMPUTO > MOVEMENTS BY ASSIGNMENT	261	382	3
482	MOVEMENTS BY ASSIGNMENT	SITE > COMPUTO > MOVEMENTS BY ASSIGNMENT	261	463	3
404	MOVEMENTS BY WITHDRAWAL	REMOTE > COMPUTO > MOVEMENTS BY WITHDRAWAL	261	382	3
130	Movimiento	HARDWARE > Movimiento	101	125	2
159	Movimientos equipos Invest in Bogotá	SOPORTE Y SERVICIOS > Movimientos equipos Invest in Bogotá	95	19	2
208	Movimientos por asignación	SITIO > COMPUTO > Movimientos por asignación	84	212	3
260	Movimientos por asignación	REMOTO > COMPUTO > Movimientos por asignación	84	259	3
283	Movimientos por retiro	SITIO > COMPUTO > Movimientos por retiro	84	212	3
290	Movimientos por retiro	REMOTO > COMPUTO > Movimientos por retiro	84	259	3
30	NAS	SOPORTE Y SERVICIOS > NAS	84	19	2
466	NAS	SUPPORT AND SERVICES > NAS	261	440	2
428	NAS CONFIGURATION	BACKUP SOLUTIONS > NAS CONFIGURATION	261	425	2
505	NAS CONFIGURATION	SITE > BACKUP SOLUTIONS > NAS CONFIGURATION	261	503	3
354	NETWORKS	INFRASTRUCTURE > NETWORKS	261	351	2
378	NETWORKS AND INTERNET	REMOTE > NETWORKS AND INTERNET	261	368	2
472	NETWORKS AND INTERNET	SUPPORT AND SERVICES > NETWORKS AND INTERNET	261	440	2
497	NETWORKS AND INTERNET	SITE > NETWORKS AND INTERNET	261	434	2
3	Office	SOPORTE Y SERVICIOS > Office	84	19	2
468	OFFICE	SUPPORT AND SERVICES > OFFICE	261	440	2
206	Office 365	SITIO > APLICACIONES > Office 365	84	215	3
251	Office 365	REMOTO > APLICACIONES > Office 365	84	247	3
406	OFFICE 365	REMOTE > APPLICATIONS > OFFICE 365	261	371	3
453	OFFICE 365	SITE > APPLICATIONS > OFFICE 365	261	439	3
478	ON-SITE SUPPORT	SUPPORT AND SERVICES > ON-SITE SUPPORT	261	440	2
461	On-site technical support	SITE > On-site technical support	261	434	2
414	OPERATING SYSTEM	REMOTE > COMPUTO > OPERATING SYSTEM	261	382	3
486	OPERATING SYSTEM	SITE > COMPUTO > OPERATING SYSTEM	261	463	3
284	Oportunidad Generada	COMERCIAL > Oportunidad Generada	84	22	2
407	OTHER  APPLICATIONS	REMOTE > APPLICATIONS > OTHER  APPLICATIONS	261	371	3
454	OTHER APPLICATIONS	SITE > APPLICATIONS > OTHER APPLICATIONS	261	439	3
469	OTHERS	SUPPORT AND SERVICES > OTHERS	261	440	2
238	Otras aplicaciones	SITIO > APLICACIONES > Otras aplicaciones	84	215	3
252	Otras aplicaciones	REMOTO > APLICACIONES > Otras aplicaciones	84	247	3
21	Otros	SOPORTE Y SERVICIOS > Otros	84	19	2
211	Otros Antivirus	SITIO > ANTIVIRUS > Otros Antivirus	84	200	3
246	Otros Antivirus	REMOTO > ANTIVIRUS > Otros Antivirus	84	235	3
390	OTROS ANTIVIRUS	REMOTE > ANTIVIRUS > OTROS ANTIVIRUS	261	370	3
438	OTROS ANTIVIRUS	SITE > ANTIVIRUS > OTROS ANTIVIRUS	261	435	3
124	Otros Servidores	Otros Servidores	0	0	1
417	OUTLOOK CONFIGURATION	REMOTE > EMAIL > OUTLOOK CONFIGURATION	261	375	3
490	OUTLOOK CONFIGURATION	SITE > EMAIL > OUTLOOK CONFIGURATION	261	487	3
349	WARRANTIES	WARRANTIES	261	0	1
348	WEB PORTAL SUPPORT	DEVELOPMENT > WEB PORTAL SUPPORT	261	339	2
361	WITHDRAWAL	LOGISTICS > WITHDRAWAL	261	359	2
483	WITHDRAWAL MOVEMENTS	SITE > COMPUTO > WITHDRAWAL MOVEMENTS	261	463	3
69	WMS	WMS	0	0	1
80	Word Office	APLICACIONES DE TERCEROS > Word Office	84	77	2
229	Word Office	SITIO > APLICACIONES > Word Office	84	215	3
255	Word Office	REMOTO > APLICACIONES > Word Office	84	247	3
334	WORD OFFICE	THIRD-PARTY APPLICATIONS > WORD OFFICE	261	322	2
413	WORD OFFICE	REMOTE > APPLICATIONS > WORD OFFICE	261	371	3
459	WORD OFFICE	SITE > APPLICATIONS > WORD OFFICE	261	439	3
70	Workspace	Workspace	0	0	1
381	XXXX	REMOTE > XXXX	261	368	2"""


def escape(s):
    return xml.sax.saxutils.escape(s or "")


def main():
    rows = []
    seen_ids = set()
    parent_ids_ref = set()
    for line in RAW.strip().splitlines():
        parts = line.split("\t")
        if len(parts) < 6:
            continue
        gid = parts[0].strip()
        name = parts[1].strip()
        parent_id = parts[4].strip()
        level = parts[5].strip()
        if not gid or not name:
            continue
        gid_int = int(gid)
        seen_ids.add(gid_int)
        if parent_id and parent_id != "0":
            parent_ids_ref.add(int(parent_id))
        rows.append((gid_int, name, parent_id, level))
    # Stubs para padres referenciados que no están en el listado (nombre neutro, estilo Odoo)
    missing_parents = parent_ids_ref - seen_ids
    for pid in sorted(missing_parents):
        rows.append((pid, "General", "0", "1"))
        seen_ids.add(pid)
    # Ordenar por level luego id para que los padres existan antes que los hijos
    rows.sort(key=lambda r: (int(r[3]), r[0]))
    # noupdate=0 para que al actualizar se corrijan los nombres de los stubs (sin "GLPI")
    out = ['<?xml version="1.0" encoding="utf-8"?>', '<odoo>', '    <data noupdate="0">']
    for gid, name, parent_id, level in rows:
        ext_id = "glpi_cat_%s" % gid
        parent_ref = ('<field name="parent_id" ref="glpi_cat_%s"/>' % parent_id) if parent_id and parent_id != "0" else '<field name="parent_id" ref=""/>'
        if parent_id and parent_id != "0":
            parent_ref = '<field name="parent_id" ref="glpi_cat_%s"/>' % parent_id
        else:
            parent_ref = ''
        out.append('        <record id="%s" model="helpdesk.ticket.category">' % ext_id)
        out.append('            <field name="name">%s</field>' % escape(name))
        if parent_ref:
            out.append('            %s' % parent_ref)
        out.append('            <field name="level">%s</field>' % escape(level))
        out.append('        </record>')
    out.append('    </data>')
    out.append('</odoo>')
    return "\n".join(out)


if __name__ == "__main__":
    import sys
    p = r"c:\Users\yhernandez.SUPPLIESDC\Music\Modulos Odoo\mesa_ayuda_inventario\data\helpdesk_ticket_category_data.xml"
    with open(p, "w", encoding="utf-8") as f:
        f.write(main())
    print("Written:", p)
