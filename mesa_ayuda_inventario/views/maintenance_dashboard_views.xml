<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ========================================== -->
    <!-- VISTA 1: DASHBOARD GENERAL (OVERVIEW) -->
    <!-- ========================================== -->
    <record id="view_maintenance_dashboard_general" model="ir.ui.view">
        <field name="name">maintenance.dashboard.general</field>
        <field name="model">maintenance.dashboard</field>
        <field name="arch" type="xml">
            <form create="0" string="Dashboard General - Resumen Ejecutivo" class="o_form_view">
                <header>
                    <field name="name" invisible="1"/>
                </header>
                <sheet style="max-width: 100% !important; width: 100% !important;">
                    <div class="oe_button_box" name="button_box">
                        <button name="action_refresh_dashboard" type="object" 
                                class="oe_stat_button" icon="fa-refresh"
                                string="Actualizar"/>
                        <button name="action_export_excel" type="object" 
                                class="oe_stat_button" icon="fa-file-excel-o"
                                string="Exportar a Excel"
                                title="Exportar dashboard a Excel"/>
                        <button name="action_export_pdf" type="object" 
                                class="oe_stat_button" icon="fa-file-pdf-o"
                                string="Exportar a PDF"
                                title="Exportar dashboard a PDF"/>
                    </div>
                    <div style="padding: 1.5vw 2vw; width: 100%; max-width: 100%; box-sizing: border-box;">
                        <!-- Filtros -->
                        <div style="margin-bottom: 30px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">
                            <h3 style="color: #2c3e50; margin-top: 0; margin-bottom: 15px; font-size: 18px;">üîç Filtros</h3>
                            <group>
                                <group>
                                    <field name="date_from" widget="date" string="Fecha Desde" options="{'datepicker': {'daysOfWeekDisabled': []}}"/>
                                </group>
                                <group>
                                    <field name="date_to" widget="date" string="Fecha Hasta" options="{'datepicker': {'daysOfWeekDisabled': []}}"/>
                                </group>
                                <group>
                                    <field name="technician_id" string="T√©cnico" 
                                           options="{'no_create': True, 'no_open': True}"
                                           placeholder="Filtrar por t√©cnico..."/>
                                </group>
                            </group>
                            <div style="margin-top: 15px; text-align: right;">
                                <button name="action_refresh_dashboard" type="object" string="Aplicar Filtros y Actualizar" class="btn-primary" icon="fa-filter"/>
                            </div>
                            <field name="dashboard_type" invisible="1"/>
                        </div>
                        
                        <!-- Encabezado Principal -->
                        <div style="text-align: center; margin-bottom: 40px; padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px; color: white; box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);">
                            <h1 style="margin: 0; font-size: 36px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">
                                üìä Dashboard General
                            </h1>
                            <p style="margin: 15px 0 0 0; font-size: 18px; opacity: 0.95;">
                                Vista Ejecutiva del Sistema de Mantenimiento
                            </p>
                        </div>

                        <!-- M√©tricas Generales - 4 Columnas -->
                        <div style="margin-bottom: 40px;">
                            <h2 style="color: #2c3e50; margin-bottom: 25px; font-size: 22px; border-bottom: 3px solid #667eea; padding-bottom: 12px;">
                                üìà Resumen Ejecutivo
                            </h2>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5vw; width: 100%;">
                                <!-- Mantenimientos Total -->
                                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px; padding: 30px; color: white; box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4); text-align: center; position: relative; overflow: hidden;">
                                    <div style="position: absolute; top: -20px; right: -20px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
                                    <div style="font-size: 16px; opacity: 0.95; margin-bottom: 15px; font-weight: 600; position: relative;">
                                        üîß Mantenimientos
                                    </div>
                                    <div style="font-size: 48px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.3); position: relative;">
                                        <field name="total_maintenances" readonly="1"/>
                                    </div>
                                    <div style="margin-top: 15px; font-size: 14px; opacity: 0.9;">
                                        <div>‚úì Completados: <field name="completed_maintenances" readonly="1"/></div>
                                        <div>‚è≥ Pendientes: <field name="pending_maintenances" readonly="1"/></div>
                                    </div>
                                </div>
                                
                                <!-- √ìrdenes/Visitas -->
                                <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 16px; padding: 30px; color: white; box-shadow: 0 6px 20px rgba(67, 233, 123, 0.4); text-align: center; position: relative; overflow: hidden;">
                                    <div style="position: absolute; top: -20px; right: -20px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
                                    <div style="font-size: 16px; opacity: 0.95; margin-bottom: 15px; font-weight: 600; position: relative;">
                                        üìÖ √ìrdenes de Servicio
                                    </div>
                                    <div style="font-size: 48px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.3); position: relative;">
                                        <field name="total_orders" readonly="1"/>
                                    </div>
                                    <div style="margin-top: 15px; font-size: 14px; opacity: 0.9;">
                                        <div>‚úì Completadas: <field name="completed_orders" readonly="1"/></div>
                                        <div>üìã Programadas: <field name="scheduled_orders" readonly="1"/></div>
                                    </div>
                                </div>
                                
                                <!-- Tickets -->
                                <div style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); border-radius: 16px; padding: 30px; color: white; box-shadow: 0 6px 20px rgba(48, 207, 208, 0.4); text-align: center; position: relative; overflow: hidden;">
                                    <div style="position: absolute; top: -20px; right: -20px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
                                    <div style="font-size: 16px; opacity: 0.95; margin-bottom: 15px; font-weight: 600; position: relative;">
                                        üé´ Tickets
                                    </div>
                                    <div style="font-size: 48px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.3); position: relative;">
                                        <field name="total_tickets" readonly="1"/>
                                    </div>
                                    <div style="margin-top: 15px; font-size: 14px; opacity: 0.9;">
                                        <div>üîì Abiertos: <field name="open_tickets" readonly="1"/></div>
                                        <div>üîí Cerrados: <field name="total_tickets" readonly="1"/> - <field name="open_tickets" readonly="1"/></div>
                                    </div>
                                </div>
                                
                                <!-- Reparaciones -->
                                <div style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); border-radius: 16px; padding: 30px; color: #2c3e50; box-shadow: 0 6px 20px rgba(255, 154, 158, 0.4); text-align: center; position: relative; overflow: hidden;">
                                    <div style="position: absolute; top: -20px; right: -20px; width: 100px; height: 100px; background: rgba(0,0,0,0.05); border-radius: 50%;"></div>
                                    <div style="font-size: 16px; opacity: 0.9; margin-bottom: 15px; font-weight: 600; position: relative;">
                                        üîß Reparaciones
                                    </div>
                                    <div style="font-size: 48px; font-weight: bold; position: relative;">
                                        <field name="total_repairs" readonly="1"/>
                                    </div>
                                    <div style="margin-top: 15px; font-size: 14px; opacity: 0.85;">
                                        <div>‚öôÔ∏è Activas: <field name="active_repairs" readonly="1"/></div>
                                        <div>‚úì Completadas: <field name="total_repairs" readonly="1"/> - <field name="active_repairs" readonly="1"/></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Alertas y Estados Cr√≠ticos -->
                        <div style="margin-bottom: 40px;">
                            <h2 style="color: #2c3e50; margin-bottom: 25px; font-size: 22px; border-bottom: 3px solid #f5576c; padding-bottom: 12px;">
                                ‚ö†Ô∏è Alertas y Estados Cr√≠ticos
                            </h2>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5vw; width: 100%;">
                                <!-- Mantenimientos Vencidos -->
                                <div style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: 16px; padding: 25px; color: white; box-shadow: 0 6px 20px rgba(250, 112, 154, 0.4); text-align: center;">
                                    <div style="font-size: 16px; opacity: 0.95; margin-bottom: 15px; font-weight: 600;">
                                        ‚è∞ Mantenimientos Vencidos
                                    </div>
                                    <div style="font-size: 56px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">
                                        <field name="overdue_maintenances" readonly="1"/>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Accesos R√°pidos -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 25px; font-size: 22px; border-bottom: 3px solid #667eea; padding-bottom: 12px;">
                                üöÄ Accesos R√°pidos
                            </h2>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5vw; width: 100%;">
                                <button name="action_open_visits_dashboard" type="object" 
                                        style="padding: 25px; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 12px; color: white; text-align: center; border: none; cursor: pointer; box-shadow: 0 4px 15px rgba(67, 233, 123, 0.3); transition: transform 0.2s;"
                                        class="btn btn-primary">
                                    <div style="font-size: 40px; margin-bottom: 12px;">üìÖ</div>
                                    <div style="font-size: 20px; font-weight: bold; margin-bottom: 5px;">M√©tricas de Visitas</div>
                                    <div style="font-size: 14px; opacity: 0.95;">Ver an√°lisis detallado de visitas</div>
                                </button>
                                <button name="action_open_maintenance_dashboard" type="object" 
                                        style="padding: 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white; text-align: center; border: none; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); transition: transform 0.2s;"
                                        class="btn btn-primary">
                                    <div style="font-size: 40px; margin-bottom: 12px;">üîß</div>
                                    <div style="font-size: 20px; font-weight: bold; margin-bottom: 5px;">M√©tricas de Mantenimientos</div>
                                    <div style="font-size: 14px; opacity: 0.95;">Ver an√°lisis detallado de mantenimientos</div>
                                </button>
                            </div>
                        </div>

                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!-- ========================================== -->
    <!-- VISTA 2: M√âTRICAS DE VISITAS -->
    <!-- ========================================== -->
    <record id="view_maintenance_dashboard_visits" model="ir.ui.view">
        <field name="name">maintenance.dashboard.visits</field>
        <field name="model">maintenance.dashboard</field>
        <field name="arch" type="xml">
            <form create="0" string="M√©tricas de Visitas y √ìrdenes de Servicio" class="o_form_view">
                <header>
                    <field name="name" invisible="1"/>
                    <!-- Campos JSON invisibles para gr√°ficos de visitas -->
                    <field name="visit_by_technician_json" invisible="1" widget="text"/>
                    <field name="visit_by_type_json" invisible="1" widget="text"/>
                    <field name="visit_monthly_trend_json" invisible="1" widget="text"/>
                    <field name="visit_compliance_json" invisible="1" widget="text"/>
                </header>
                <sheet style="max-width: 100% !important; width: 100% !important;">
                    <div class="oe_button_box" name="button_box">
                        <button name="action_refresh_dashboard" type="object" 
                                class="oe_stat_button" icon="fa-refresh"
                                string="Actualizar"/>
                        <button name="action_export_excel" type="object" 
                                class="oe_stat_button" icon="fa-file-excel-o"
                                string="Exportar a Excel"/>
                        <button name="action_export_pdf" type="object" 
                                class="oe_stat_button" icon="fa-file-pdf-o"
                                string="Exportar a PDF"/>
                    </div>
                    <div style="padding: 1.5vw 2vw; width: 100%; max-width: 100%; box-sizing: border-box;">
                        <!-- Filtros -->
                        <div style="margin-bottom: 30px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">
                            <h3 style="color: #2c3e50; margin-top: 0; margin-bottom: 15px; font-size: 18px;">üîç Filtros</h3>
                            <group>
                                <group>
                                    <field name="date_from" widget="date" string="Fecha Desde" options="{'datepicker': {'daysOfWeekDisabled': []}}"/>
                                </group>
                                <group>
                                    <field name="date_to" widget="date" string="Fecha Hasta" options="{'datepicker': {'daysOfWeekDisabled': []}}"/>
                                </group>
                                <group>
                                    <field name="technician_id" string="T√©cnico" 
                                           options="{'no_create': True, 'no_open': True}"
                                           placeholder="Filtrar por t√©cnico..."/>
                                </group>
                            </group>
                            <div style="margin-top: 15px; text-align: right;">
                                <button name="action_refresh_dashboard" type="object" string="Aplicar Filtros y Actualizar" class="btn-primary" icon="fa-filter"/>
                            </div>
                            <field name="dashboard_type" invisible="1"/>
                        </div>
                        
                        <!-- Encabezado -->
                        <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 12px; color: white; box-shadow: 0 4px 15px rgba(67, 233, 123, 0.3);">
                            <h1 style="margin: 0; font-size: 32px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                üìÖ M√©tricas de Visitas y √ìrdenes de Servicio
                            </h1>
                            <p style="margin: 10px 0 0 0; font-size: 16px; opacity: 0.95;">
                                An√°lisis Detallado de Visitas Programadas
                            </p>
                        </div>

                        <!-- M√©tricas de √ìrdenes -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #43e97b; padding-bottom: 10px;">
                                üìä Resumen de √ìrdenes
                            </h2>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                    <div style="font-size: 16px; margin-bottom: 10px;">Total √ìrdenes</div>
                                    <div style="font-size: 42px; font-weight: bold;"><field name="total_orders" readonly="1" nolabel="1"/></div>
                                </div>
                                <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                    <div style="font-size: 16px; margin-bottom: 10px;">Programadas</div>
                                    <div style="font-size: 42px; font-weight: bold;"><field name="scheduled_orders" readonly="1" nolabel="1"/></div>
                                </div>
                                <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                    <div style="font-size: 16px; margin-bottom: 10px;">Completadas</div>
                                    <div style="font-size: 42px; font-weight: bold;"><field name="completed_orders" readonly="1" nolabel="1"/></div>
                                </div>
                                <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                    <div style="font-size: 16px; margin-bottom: 10px;">Visitas Programadas</div>
                                    <div style="font-size: 42px; font-weight: bold;"><field name="visit_orders" readonly="1" nolabel="1"/></div>
                                </div>
                            </div>
                        </div>
                            
                        <!-- Gr√°fico: Visitas por T√©cnico -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #43e97b; padding-bottom: 10px;">
                                üë• Visitas Programadas por T√©cnico
                            </h2>
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; min-height: 400px;">
                                <canvas id="chartVisitByTechnician"></canvas>
                            </div>
                            <field name="visit_by_technician_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="technician_id"/>
                                    <field name="total_orders" string="Total"/>
                                    <field name="completed_orders" string="Completadas"/>
                                    <field name="scheduled_orders" string="Programadas"/>
                                </list>
                            </field>
                        </div>
                            
                        <!-- Gr√°fico: Visitas por Tipo -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #43e97b; padding-bottom: 10px;">
                                üéØ Visitas por Tipo de Actividad
                            </h2>
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; justify-content: center; min-height: 250px; max-height: 300px;">
                                <canvas id="chartVisitByType" style="max-width: 400px; max-height: 300px;"></canvas>
                            </div>
                            <field name="visit_by_type_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="type_label" string="Tipo"/>
                                    <field name="total_orders" string="Total"/>
                                    <field name="completed_orders" string="Completadas"/>
                                </list>
                            </field>
                        </div>
                            
                        <!-- Gr√°fico: Tendencia Mensual de Visitas -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #43e97b; padding-bottom: 10px;">
                                üìà Tendencia Mensual de Visitas
                            </h2>
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; min-height: 400px;">
                                <canvas id="chartVisitMonthlyTrend"></canvas>
                            </div>
                            <field name="visit_monthly_trend_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="month" string="Mes"/>
                                    <field name="total_orders" string="Total"/>
                                    <field name="completed_orders" string="Completadas"/>
                                    <field name="scheduled_orders" string="Programadas"/>
                                </list>
                            </field>
                        </div>
                            
                        <!-- Gr√°fico: Cumplimiento de Visitas -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #43e97b; padding-bottom: 10px;">
                                ‚úÖ Cumplimiento de Visitas
                            </h2>
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; justify-content: center; min-height: 400px;">
                                <canvas id="chartVisitCompliance"></canvas>
                            </div>
                        </div>

                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!-- ========================================== -->
    <!-- VISTA 3: M√âTRICAS DE MANTENIMIENTOS -->
    <!-- ========================================== -->
    <record id="view_maintenance_dashboard_maintenance" model="ir.ui.view">
        <field name="name">maintenance.dashboard.maintenance</field>
        <field name="model">maintenance.dashboard</field>
        <field name="arch" type="xml">
            <form create="0" string="M√©tricas de Mantenimientos" class="o_form_view">
                <header>
                    <field name="name" invisible="1"/>
                    <!-- Campos JSON invisibles para gr√°ficos de mantenimientos -->
                    <field name="monthly_trend_json" invisible="1" widget="text"/>
                    <field name="type_distribution_json" invisible="1" widget="text"/>
                    <field name="weekday_activity_json" invisible="1" widget="text"/>
                    <field name="technician_performance_json" invisible="1" widget="text"/>
                </header>
                <sheet style="max-width: 100% !important; width: 100% !important;">
                    <div class="oe_button_box" name="button_box">
                        <button name="action_refresh_dashboard" type="object" 
                                class="oe_stat_button" icon="fa-refresh"
                                string="Actualizar"/>
                        <button name="action_export_excel" type="object" 
                                class="oe_stat_button" icon="fa-file-excel-o"
                                string="Exportar a Excel"/>
                        <button name="action_export_pdf" type="object" 
                                class="oe_stat_button" icon="fa-file-pdf-o"
                                string="Exportar a PDF"/>
                    </div>
                    <div style="padding: 1.5vw 2vw; width: 100%; max-width: 100%; box-sizing: border-box;">
                        <!-- Filtros -->
                        <div style="margin-bottom: 30px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">
                            <h3 style="color: #2c3e50; margin-top: 0; margin-bottom: 15px; font-size: 18px;">üîç Filtros</h3>
                            <group>
                                <group>
                                    <field name="date_from" widget="date" string="Fecha Desde" options="{'datepicker': {'daysOfWeekDisabled': []}}"/>
                                </group>
                                <group>
                                    <field name="date_to" widget="date" string="Fecha Hasta" options="{'datepicker': {'daysOfWeekDisabled': []}}"/>
                                </group>
                                <group>
                                    <field name="technician_id" string="T√©cnico" 
                                           options="{'no_create': True, 'no_open': True}"
                                           placeholder="Filtrar por t√©cnico..."/>
                                </group>
                            </group>
                            <div style="margin-top: 15px; text-align: right;">
                                <button name="action_refresh_dashboard" type="object" string="Aplicar Filtros y Actualizar" class="btn-primary" icon="fa-filter"/>
                            </div>
                            <field name="dashboard_type" invisible="1"/>
                        </div>
                        
                        <!-- Encabezado -->
                        <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
                            <h1 style="margin: 0; font-size: 32px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                üîß M√©tricas de Mantenimientos
                            </h1>
                            <p style="margin: 10px 0 0 0; font-size: 16px; opacity: 0.95;">
                                An√°lisis Detallado de Mantenimientos de Equipos
                            </p>
                        </div>

                        <!-- M√©tricas Principales - Mantenimientos -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #667eea; padding-bottom: 10px;">
                                üìä Resumen de Mantenimientos
                            </h2>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                                <!-- Total Mantenimientos -->
                                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); text-align: center;">
                                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 10px; font-weight: 600;">
                                        Total Mantenimientos
                                    </div>
                                    <div style="font-size: 42px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                        <field name="total_maintenances" readonly="1"/>
                                    </div>
                                </div>
                                
                                <!-- Pendientes -->
                                <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(245, 87, 108, 0.3); text-align: center;">
                                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 10px; font-weight: 600;">
                                        Pendientes
                                    </div>
                                    <div style="font-size: 42px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                        <field name="pending_maintenances" readonly="1"/>
                                    </div>
                                </div>
                                
                                <!-- Completados -->
                                <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3); text-align: center;">
                                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 10px; font-weight: 600;">
                                        Completados
                                    </div>
                                    <div style="font-size: 42px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                        <field name="completed_maintenances" readonly="1"/>
                                    </div>
                                </div>
                                
                                <!-- Vencidos -->
                                <div style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(250, 112, 154, 0.3); text-align: center;">
                                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 10px; font-weight: 600;">
                                        Vencidos
                                    </div>
                                    <div style="font-size: 42px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                        <field name="overdue_maintenances" readonly="1"/>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Rendimiento por T√©cnico -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #667eea; padding-bottom: 10px;">
                                üë• Rendimiento por T√©cnico
                            </h2>
                            <!-- Datos JSON ocultos -->
                            <div id="technicianPerformanceData" style="display: none;">
                                <field name="technician_performance_json" invisible="1" widget="text"/>
                            </div>
                            <!-- Gr√°fico Visual -->
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; min-height: 400px;">
                                <canvas id="chartTechnicianPerformance"></canvas>
                            </div>
                            <!-- Tabla de Datos -->
                            <field name="technician_performance_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="technician_id"/>
                                    <field name="total_maintenances" string="Total"/>
                                    <field name="completed_maintenances" string="Completados"/>
                                    <field name="completion_rate" string="% Completados" widget="percentage"/>
                                </list>
                            </field>
                        </div>

                        <!-- Resumen por Cliente -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #667eea; padding-bottom: 10px;">
                                üè¢ Mantenimientos por Cliente
                            </h2>
                            <field name="client_maintenance_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="partner_id"/>
                                    <field name="total_maintenances" string="Total"/>
                                    <field name="pending_maintenances" string="Pendientes"/>
                                    <field name="completed_maintenances" string="Completados"/>
                                </list>
                            </field>
                        </div>

                        <!-- Gr√°fico de Tendencia Mensual -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #667eea; padding-bottom: 10px;">
                                üìà Tendencia Mensual de Mantenimientos
                            </h2>
                            <!-- Datos JSON ocultos -->
                            <div id="monthlyTrendData" style="display: none;">
                                <field name="monthly_trend_json" invisible="1" widget="text"/>
                            </div>
                            <!-- Gr√°fico Visual -->
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; min-height: 400px; position: relative;">
                                <canvas id="chartMonthlyTrend" style="width: 100%; height: 400px;"></canvas>
                                <div id="chartMonthlyTrendStatus" style="position: absolute; top: 10px; right: 10px; font-size: 12px; color: #666; display: none;"></div>
                            </div>
                            <!-- Tabla de Datos -->
                            <field name="monthly_trend_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="month" string="Mes"/>
                                    <field name="total_maintenances" string="Total"/>
                                    <field name="completed_maintenances" string="Completados"/>
                                    <field name="pending_maintenances" string="Pendientes"/>
                                </list>
                            </field>
                        </div>

                        <!-- Gr√°fico de Distribuci√≥n por Tipo -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #667eea; padding-bottom: 10px;">
                                ü•ß Distribuci√≥n por Tipo de Mantenimiento
                            </h2>
                            <!-- Datos JSON ocultos -->
                            <div id="typeDistributionData" style="display: none;">
                                <field name="type_distribution_json" invisible="1" widget="text"/>
                            </div>
                            <!-- Gr√°fico Visual -->
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; justify-content: center; min-height: 400px;">
                                <canvas id="chartTypeDistribution" style="max-width: 500px; max-height: 500px;"></canvas>
                            </div>
                            <!-- Tabla de Datos -->
                            <field name="type_distribution_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="type_label" string="Tipo de Mantenimiento"/>
                                    <field name="count" string="Cantidad"/>
                                </list>
                            </field>
                        </div>

                        <!-- Gr√°fico de Actividad por D√≠a de Semana -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #667eea; padding-bottom: 10px;">
                                üìÖ Actividad por D√≠a de la Semana
                            </h2>
                            <!-- Datos JSON ocultos -->
                            <div id="weekdayActivityData" style="display: none;">
                                <field name="weekday_activity_json" invisible="1" widget="text"/>
                            </div>
                            <!-- Gr√°fico Visual -->
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; min-height: 400px;">
                                <canvas id="chartWeekdayActivity"></canvas>
                            </div>
                            <!-- Tabla de Datos -->
                            <field name="weekday_activity_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="weekday_label" string="D√≠a"/>
                                    <field name="count" string="Cantidad de Mantenimientos"/>
                                </list>
                            </field>
                        </div>

                        <!-- Tiempo Promedio de Resoluci√≥n -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #667eea; padding-bottom: 10px;">
                                ‚è±Ô∏è Tiempo Promedio de Resoluci√≥n por Tipo
                            </h2>
                            <field name="avg_resolution_time_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="type_label" string="Tipo de Mantenimiento"/>
                                    <field name="avg_hours" string="Promedio (Horas)" widget="float"/>
                                    <field name="count" string="Cantidad"/>
                                </list>
                            </field>
                        </div>

                        <!-- Equipos M√°s Problem√°ticos -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #667eea; padding-bottom: 10px;">
                                ‚ö†Ô∏è Equipos M√°s Problem√°ticos (Top 10)
                            </h2>
                            <field name="problematic_equipment_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="equipment_name" string="Equipo"/>
                                    <field name="inventory_plate" string="Placa de Inventario"/>
                                    <field name="total_maintenances" string="Total"/>
                                    <field name="completed_maintenances" string="Completados"/>
                                    <field name="pending_maintenances" string="Pendientes"/>
                                </list>
                            </field>
                        </div>

                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!-- ========================================== -->
    <!-- VISTA 4: ESTAD√çSTICAS DE T√âCNICOS -->
    <!-- ========================================== -->
    <record id="view_maintenance_dashboard_technicians" model="ir.ui.view">
        <field name="name">maintenance.dashboard.technicians</field>
        <field name="model">maintenance.dashboard</field>
        <field name="arch" type="xml">
            <form create="0" string="Estad√≠sticas de T√©cnicos" class="o_form_view">
                <header>
                    <field name="name" invisible="1"/>
                    <!-- Campos JSON invisibles para gr√°ficos -->
                    <field name="technician_performance_json" invisible="1" widget="text"/>
                    <field name="visit_by_technician_json" invisible="1" widget="text"/>
                </header>
                <sheet style="max-width: 100% !important; width: 100% !important;">
                    <div class="oe_button_box" name="button_box">
                        <button name="action_refresh_dashboard" type="object" 
                                class="oe_stat_button" icon="fa-refresh"
                                string="Actualizar"/>
                        <button name="action_export_technicians_excel" type="object" 
                                class="oe_stat_button" icon="fa-file-excel-o"
                                string="Exportar a Excel"
                                title="Exportar estad√≠sticas de t√©cnicos a Excel"/>
                        <button name="action_export_technicians_pdf" type="object" 
                                class="oe_stat_button" icon="fa-file-pdf-o"
                                string="Exportar a PDF"
                                title="Exportar estad√≠sticas de t√©cnicos a PDF"/>
                    </div>
                    <div style="padding: 1.5vw 2vw; width: 100%; max-width: 100%; box-sizing: border-box;">
                        <!-- Filtros -->
                        <div style="margin-bottom: 30px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">
                            <h3 style="color: #2c3e50; margin-top: 0; margin-bottom: 15px; font-size: 18px;">üîç Filtros</h3>
                            <group>
                                <group>
                                    <field name="date_from" widget="date" string="Fecha Desde" options="{'datepicker': {'daysOfWeekDisabled': []}}"/>
                                </group>
                                <group>
                                    <field name="date_to" widget="date" string="Fecha Hasta" options="{'datepicker': {'daysOfWeekDisabled': []}}"/>
                                </group>
                                <group>
                                    <field name="technician_id" string="T√©cnico" 
                                           options="{'no_create': True, 'no_open': True}"
                                           placeholder="Filtrar por t√©cnico espec√≠fico (opcional)..."/>
                                </group>
                            </group>
                            <div style="margin-top: 15px; text-align: right;">
                                <button name="action_refresh_dashboard" type="object" string="Aplicar Filtros y Actualizar" class="btn-primary" icon="fa-filter"/>
                            </div>
                            <field name="dashboard_type" invisible="1"/>
                        </div>
                        
                        <!-- Encabezado -->
                        <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 12px; color: white; box-shadow: 0 4px 15px rgba(245, 87, 108, 0.3);">
                            <h1 style="margin: 0; font-size: 32px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                üë• Estad√≠sticas de T√©cnicos
                            </h1>
                            <p style="margin: 10px 0 0 0; font-size: 16px; opacity: 0.95;">
                                An√°lisis Detallado de Rendimiento y Productividad
                            </p>
                        </div>

                        <!-- Resumen de T√©cnicos -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #f5576c; padding-bottom: 10px;">
                                üìä Resumen General
                            </h2>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
                                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 10px; font-weight: 600;">
                                        Total T√©cnicos
                                    </div>
                                    <div style="font-size: 42px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                        <field name="technician_performance_ids" widget="statinfo" options="{'count': true}" nolabel="1"/>
                                    </div>
                                </div>
                                <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 15px rgba(245, 87, 108, 0.3);">
                                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 10px; font-weight: 600;">
                                        Total Mantenimientos
                                    </div>
                                    <div style="font-size: 42px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                        <field name="total_maintenances" readonly="1"/>
                                    </div>
                                </div>
                                <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);">
                                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 10px; font-weight: 600;">
                                        Mantenimientos Completados
                                    </div>
                                    <div style="font-size: 42px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                        <field name="completed_maintenances" readonly="1"/>
                                    </div>
                                </div>
                                <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 15px rgba(67, 233, 123, 0.3);">
                                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 10px; font-weight: 600;">
                                        Total √ìrdenes/Visitas
                                    </div>
                                    <div style="font-size: 42px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                        <field name="total_orders" readonly="1"/>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tabla de Rendimiento por T√©cnico - Mantenimientos -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #f5576c; padding-bottom: 10px;">
                                üîß Rendimiento en Mantenimientos
                            </h2>
                            <field name="technician_performance_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="technician_id" string="T√©cnico"/>
                                    <field name="total_maintenances" string="Total Mantenimientos"/>
                                    <field name="completed_maintenances" string="Completados"/>
                                    <field name="completion_rate" string="% Completados" widget="percentage"/>
                                </list>
                            </field>
                        </div>

                        <!-- Gr√°fico: Rendimiento por T√©cnico -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #f5576c; padding-bottom: 10px;">
                                üìä Gr√°fico de Rendimiento - Mantenimientos
                            </h2>
                            <!-- Datos JSON ocultos -->
                            <div id="technicianPerformanceData" style="display: none;">
                                <field name="technician_performance_json" invisible="1" widget="text"/>
                            </div>
                            <!-- Gr√°fico Visual -->
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; min-height: 400px;">
                                <canvas id="chartTechnicianPerformance"></canvas>
                            </div>
                        </div>

                        <!-- Tabla de Visitas por T√©cnico -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #43e97b; padding-bottom: 10px;">
                                üìÖ Rendimiento en Visitas/√ìrdenes
                            </h2>
                            <field name="visit_by_technician_ids" nolabel="1" readonly="1">
                                <list>
                                    <field name="technician_id" string="T√©cnico"/>
                                    <field name="total_orders" string="Total √ìrdenes"/>
                                    <field name="completed_orders" string="Completadas"/>
                                    <field name="scheduled_orders" string="Programadas"/>
                                </list>
                            </field>
                        </div>

                        <!-- Gr√°fico: Visitas por T√©cnico -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #43e97b; padding-bottom: 10px;">
                                üìä Gr√°fico de Rendimiento - Visitas
                            </h2>
                            <!-- Datos JSON ocultos -->
                            <div id="visitTechnicianData" style="display: none;">
                                <field name="visit_by_technician_json" invisible="1" widget="text"/>
                            </div>
                            <!-- Gr√°fico Visual -->
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; min-height: 400px;">
                                <canvas id="chartVisitByTechnician"></canvas>
                            </div>
                        </div>

                        <!-- Comparativa General -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #667eea; padding-bottom: 10px;">
                                üèÜ Ranking de T√©cnicos
                            </h2>
                            <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <p style="color: #666; font-style: italic; margin-bottom: 15px;">
                                    Los t√©cnicos se muestran ordenados por porcentaje de completados. Los datos se actualizan autom√°ticamente al aplicar filtros.
                                </p>
                                <field name="technician_performance_ids" nolabel="1" readonly="1">
                                    <list default_order="completion_rate desc">
                                        <field name="technician_id" string="T√©cnico"/>
                                        <field name="total_maintenances" string="Total"/>
                                        <field name="completed_maintenances" string="Completados"/>
                                        <field name="completion_rate" string="% √âxito" widget="percentage"/>
                                    </list>
                                </field>
                            </div>
                        </div>

                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!-- ========================================== -->
    <!-- ACCIONES -->
    <!-- ========================================== -->
    
    <!-- Acci√≥n para abrir Dashboard General -->
    <record id="action_maintenance_dashboard" model="ir.actions.server">
        <field name="name">Dashboard General</field>
        <field name="model_id" ref="mesa_ayuda_inventario.model_maintenance_dashboard"/>
        <field name="state">code</field>
        <field name="code">
try:
    action = env['maintenance.dashboard'].open_general_dashboard()
except KeyError:
    action = {'type': 'ir.actions.act_window_close'}
        </field>
    </record>
    
    <!-- Acci√≥n para M√©tricas de Visitas -->
    <record id="action_maintenance_dashboard_visits" model="ir.actions.server">
        <field name="name">M√©tricas de Visitas</field>
        <field name="model_id" ref="mesa_ayuda_inventario.model_maintenance_dashboard"/>
        <field name="state">code</field>
        <field name="code">
try:
    action = env['maintenance.dashboard'].open_visits_dashboard()
except KeyError:
    action = {'type': 'ir.actions.act_window_close'}
        </field>
    </record>
    
    <!-- Acci√≥n para M√©tricas de Mantenimientos -->
    <record id="action_maintenance_dashboard_maintenance" model="ir.actions.server">
        <field name="name">M√©tricas de Mantenimientos</field>
        <field name="model_id" ref="mesa_ayuda_inventario.model_maintenance_dashboard"/>
        <field name="state">code</field>
        <field name="code">
try:
    action = env['maintenance.dashboard'].open_maintenance_dashboard()
except KeyError:
    action = {'type': 'ir.actions.act_window_close'}
        </field>
    </record>
    
    <!-- Acci√≥n para Estad√≠sticas de T√©cnicos -->
    <record id="action_maintenance_dashboard_technicians" model="ir.actions.server">
        <field name="name">Estad√≠sticas de T√©cnicos</field>
        <field name="model_id" ref="mesa_ayuda_inventario.model_maintenance_dashboard"/>
        <field name="state">code</field>
        <field name="code">
try:
    action = env['maintenance.dashboard'].open_technicians_dashboard()
except KeyError:
    action = {'type': 'ir.actions.act_window_close'}
        </field>
    </record>
    
    <!-- Acci√≥n para Reporte Excel -->
    <record id="action_report_dashboard_excel" model="ir.actions.server">
        <field name="name">Exportar a Excel</field>
        <field name="model_id" ref="base.model_res_users"/>
        <field name="state">code</field>
        <field name="code">
try:
    action = env['maintenance.dashboard'].open_general_dashboard()
except KeyError:
    action = {'type': 'ir.actions.act_window_close'}
        </field>
    </record>
    
    <!-- Acci√≥n para Reporte PDF -->
    <record id="action_report_dashboard_pdf" model="ir.actions.server">
        <field name="name">Exportar a PDF</field>
        <field name="model_id" ref="base.model_res_users"/>
        <field name="state">code</field>
        <field name="code">
try:
    action = env['maintenance.dashboard'].open_general_dashboard()
except KeyError:
    action = {'type': 'ir.actions.act_window_close'}
        </field>
    </record>
</odoo>
