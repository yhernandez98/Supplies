<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Vista que extiende el formulario de stock.lot para agregar imagen y mantenimientos -->
        <record id="view_production_lot_form_inherit_maintenance" model="ir.ui.view">
            <field name="name">production.lot.form.maintenance.inherit</field>
            <field name="model">stock.lot</field>
            <field name="inherit_id" ref="stock.view_production_lot_form"/>
            <field name="arch" type="xml">
                <!-- Agregar imagen y botÃ³n despuÃ©s del campo name -->
                <xpath expr="//field[@name='name']" position="after">
                    <div style="float: right; margin: 10px; max-width: 200px;">
                        <field name="lot_image" widget="image" 
                               options="{'preview_image': 'lot_image', 'size': [200, 200]}" 
                               style="width: 100%; max-width: 200px; max-height: 200px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.15); margin-bottom: 10px;"/>
                        <div style="width: 100%;">
                            <button name="action_generate_life_sheet" 
                                    type="object" 
                                    string="ðŸ“„ Generar Hoja de Vida" 
                                    class="btn-secondary"
                                    style="width: 100%;"
                                    icon="fa-file-pdf"
                                    title="Generar PDF con la hoja de vida completa del equipo"/>
                        </div>
                    </div>
                </xpath>
                
                <!-- Agregar pestaÃ±a de mantenimientos -->
                <xpath expr="//sheet/notebook" position="inside">
                    <page string="Mantenimientos y Revisiones" name="maintenance_history">
                        <field name="maintenance_ids" nolabel="1" context="{'default_lot_id': id}"/>
                    </page>
                    <page string="Historial de Componentes" name="component_change_history">
                        <div class="alert alert-info" role="alert" style="margin-bottom: 15px; padding: 10px 15px; background-color: #d1ecf1; border: 1px solid #0c5460; border-radius: 4px;">
                            <strong>ðŸ“‹ Historial de Cambios de Componentes:</strong> Esta pestaÃ±a muestra todos los cambios de componentes registrados en los mantenimientos de este equipo, incluyendo componentes retirados e instalados.
                        </div>
                        <group>
                            <button name="action_view_component_changes" 
                                    type="object" 
                                    string="Ver Historial Completo de Cambios de Componentes" 
                                    class="btn-primary"
                                    icon="fa-list"/>
                        </group>
                        <div style="margin-top: 20px;">
                            <p>Para ver el historial completo de cambios de componentes, haz clic en el botÃ³n arriba.</p>
                        </div>
                    </page>
                </xpath>
            </field>
        </record>
    </data>
</odoo>